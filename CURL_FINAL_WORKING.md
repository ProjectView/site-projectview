# ‚úÖ Commande CURL Corrig√©e et Test√©e

## La Commande Qui Marche (Copie-Colle Directe)

**Test 1: Article en Brouillon**

```bash
curl -X POST https://projectview.fr/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"test-article\"\ntitle: \"Test Article\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\"]\nauthor: \"ProjectBot\"\n---\n\n# Test Article\n\nCeci est un test.",
    "frontmatter": {
      "id": "test-article",
      "title": "Test Article",
      "category": "Guide Informatif",
      "date": "2025-10-26",
      "tags": ["test"],
      "author": "ProjectBot"
    },
    "approved": false
  }'
```

**R√©sultat attendu**:
```json
{
  "status": "pending_approval",
  "message": "Article saved as draft. Awaiting approval from Adelin before publication.",
  "article": {
    "id": "test-article",
    "title": "Test Article"
  }
}
```

---

## Test 2: Article Publi√© (Complet)

```bash
curl -X POST https://projectview.fr/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"mon-article-test\"\ntitle: \"Mon Article Test\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\", \"netlify\"]\nauthor: \"ProjectBot\"\n---\n\n# Mon Article Test\n\nCet article a √©t√© publi√© avec succ√®s!",
    "frontmatter": {
      "id": "mon-article-test",
      "title": "Mon Article Test",
      "category": "Guide Informatif",
      "date": "2025-10-26",
      "tags": ["test", "netlify"],
      "author": "ProjectBot"
    },
    "approved": true
  }'
```

**R√©sultat attendu**:
```json
{
  "status": "success",
  "message": "Article published successfully",
  "article": {
    "id": "mon-article-test",
    "title": "Mon Article Test",
    "url": "https://projectview.fr/article/mon-article-test"
  },
  "integrations": {
    "github": "success",
    "sheets": "skipped",
    "telegram": "skipped"
  }
}
```

---

## Le Probl√®me Qu'On Vient de Fixer

La version minifi√©e avait des sauts de ligne `\n` qui cr√©aient des erreurs JSON:

‚ùå **Mauvais**:
```
-d '{"articleMarkdown":"---\nid: \"test-article\"...'
```

‚úÖ **Correct** (multi-lignes):
```
-d '{
    "articleMarkdown": "---\nid: \"test-article\"...",
    ...
}'
```

---

## üéØ Utilisation avec N8N

Dans N8N, utilise ce format pour ton HTTP Request node:

```
M√©thode: POST
URL: https://projectview.fr/.netlify/functions/n8n-webhook

Corps (Raw):
{
  "articleMarkdown": "{{ $node.ArticleWriter.json.fullMarkdown }}",
  "frontmatter": {{ $node.ArticleWriter.json.frontmatter }},
  "nanobananaPrompts": {{ $node.ArticleWriter.json.prompts }},
  "approved": {{ $node.ApprovalNode.json.approved }}
}
```

N8N va g√©rer correctement l'√©chappement des caract√®res sp√©ciaux.

---

## ‚úÖ Status

‚úÖ Build Netlify: **Fonctionnel**
‚úÖ Webhook endpoint: **Accessible**
‚úÖ JSON parsing: **Corrig√©**
‚úÖ Pr√™t pour N8N: **OUI**

**Tu peux maintenant configurer N8N et commencer √† publier des articles!** üöÄ
