# üß™ Commande CURL pour Tester le Webhook Netlify

## Pour projectview.fr

### ‚úÖ Test 1: Article en Brouillon (Test Simple)

**Copie-colle cette commande:**

```bash
curl -X POST https://projectview.fr/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"test-article\"\ntitle: \"Test Article\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\"]\nauthor: \"ProjectBot\"\n---\n\n# Test Article\n\nCeci est un test.",
    "frontmatter": {
      "id": "test-article",
      "title": "Test Article",
      "category": "Guide Informatif",
      "date": "2025-10-26",
      "tags": ["test"],
      "author": "ProjectBot"
    },
    "approved": false
  }'
```

**R√©sultat attendu:**
```json
{
  "status": "pending_approval",
  "message": "Article saved as draft. Awaiting approval from Adelin before publication.",
  "article": {
    "id": "test-article",
    "title": "Test Article"
  }
}
```

---

### ‚úÖ Test 2: Article Publi√© (Test Complet)

**Copie-colle cette commande:**

```bash
curl -X POST https://projectview.fr/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"test-article-live\"\ntitle: \"Test Article Live\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\"]\nauthor: \"ProjectBot\"\n---\n\n# Test Article Live\n\nCet article a √©t√© publi√© avec succ√®s!",
    "frontmatter": {
      "id": "test-article-live",
      "title": "Test Article Live",
      "category": "Guide Informatif",
      "date": "2025-10-26",
      "tags": ["test"],
      "author": "ProjectBot"
    },
    "approved": true
  }'
```

**R√©sultat attendu:**
```json
{
  "status": "success",
  "message": "Article published successfully",
  "article": {
    "id": "test-article-live",
    "title": "Test Article Live",
    "url": "https://projectview.fr/article/test-article-live"
  },
  "integrations": {
    "github": "success",
    "sheets": "skipped",
    "telegram": "skipped"
  }
}
```

---

## üìç Points Importants pour projectview.fr

### 1Ô∏è‚É£ URL du Webhook
```
https://projectview.fr/.netlify/functions/n8n-webhook
```

### 2Ô∏è‚É£ V√©rifier le D√©ploiement Netlify

**Avant de tester**, assure-toi que:**

1. **Le site est bien d√©ploy√© sur Netlify**:
   - Va sur https://app.netlify.com
   - Clique sur ton site (celui li√© √† projectview.fr)
   - V√©rifie que le dernier d√©ploiement est ‚úÖ "Published"

2. **Les variables d'environnement sont configur√©es:**
   - Netlify ‚Üí ton site ‚Üí Site settings ‚Üí Build & deploy ‚Üí Environment
   - V√©rifie que `GITHUB_TOKEN`, `GITHUB_REPO_OWNER`, `GITHUB_REPO_NAME` sont pr√©sentes

3. **Le site a √©t√© red√©ploy√©** apr√®s configuration:
   - Si tu as ajout√© des variables d'env r√©cemment
   - Va dans "Deployments" et clique "Trigger deploy"

### 3Ô∏è‚É£ Format de l'ID d'Article

L'ID doit √™tre en **kebab-case** (minuscules, tirets seulement):
- ‚úÖ `test-article`
- ‚úÖ `mon-article-test`
- ‚úÖ `guide-netlify`
- ‚ùå `Test Article` (espaces)
- ‚ùå `mon_article` (underscores)
- ‚ùå `MonArticle` (majuscules)

---

## üß™ Proc√©dure de Test Compl√®te

### √âtape 1: Tester le Brouillon
```bash
curl -X POST https://projectview.fr/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"test-article\"\ntitle: \"Test Article\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\"]\nauthor: \"ProjectBot\"\n---\n\n# Test Article\n\nCeci est un test.",
    "frontmatter": {"id": "test-article", "title": "Test Article", "category": "Guide Informatif", "date": "2025-10-26", "tags": ["test"], "author": "ProjectBot"},
    "approved": false
  }'
```

‚úÖ Si tu vois `pending_approval` ‚Üí C'est bon!

---

### √âtape 2: V√©rifier les Logs Netlify
1. Va sur https://app.netlify.com
2. Clique ton site
3. Va sur "Functions" ‚Üí "n8n-webhook" ‚Üí "Logs"
4. Cherche le message de test

---

### √âtape 3: Publier l'Article
```bash
curl -X POST https://projectview.fr/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"test-article-live\"\ntitle: \"Test Article Live\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\"]\nauthor: \"ProjectBot\"\n---\n\n# Test Article Live\n\nCet article a √©t√© publi√© avec succ√®s!",
    "frontmatter": {"id": "test-article-live", "title": "Test Article Live", "category": "Guide Informatif", "date": "2025-10-26", "tags": ["test"], "author": "ProjectBot"},
    "approved": true
  }'
```

‚úÖ Si tu vois `success` ‚Üí L'article est publi√©!

---

### √âtape 4: V√©rifier sur le Site
1. **Article visible?** https://projectview.fr/article/test-article-live
2. **GitHub commit?** `git log | grep "Add article"`
3. **Google Sheets?** Nouvelle ligne (si configur√©)

---

## üÜò Troubleshooting

### Erreur: "Function not found" (404)
**Solutions:**
1. Attends quelques secondes apr√®s red√©ploiement
2. V√©rifie que Netlify a bien d√©ploy√© la version r√©cente
3. Force un red√©ploiement: Netlify ‚Üí Deployments ‚Üí "Trigger deploy"

### Erreur: "GITHUB_TOKEN not found"
**Solutions:**
1. V√©rifie que la variable est dans Netlify environment
2. Assure-toi que le site a √©t√© red√©ploy√© apr√®s ajout de la variable
3. Cherche dans les logs Netlify: Deployments ‚Üí Logs

### Erreur: "Invalid article ID"
**Solution:**
- Change l'ID en kebab-case (minuscules, tirets seulement)
- Pas d'espaces, pas d'accents, pas d'underscores

### L'article n'appara√Æt pas sur le site
**Solutions:**
1. Attends quelques secondes (red√©ploiement Vercel/Netlify)
2. Vide le cache: Cmd+Shift+R (Mac) ou Ctrl+Shift+R (Windows)
3. V√©rifie que `approved: true` dans la commande curl
4. Cherche dans les logs Netlify pour les erreurs

---

## üîó URLs Compl√®tes pour projectview.fr

| Endpoint | URL |
|----------|-----|
| **Webhook** | `https://projectview.fr/.netlify/functions/n8n-webhook` |
| **Article Test** | `https://projectview.fr/article/test-article-live` |
| **Netlify Logs** | https://app.netlify.com |

---

## üí° Notes pour projectview.fr

- ‚úÖ Domaine personnalis√©: `projectview.fr` fonctionne parfaitement
- ‚úÖ Netlify: Les functions restent accessibles via `/.netlify/functions/`
- ‚úÖ M√™me si c'est un domaine personnalis√©, la structure reste identique

---

## üöÄ Une Fois Que Tu as Test√©

1. **Configure ton N8N** avec l'URL: `https://projectview.fr/.netlify/functions/n8n-webhook`
2. **Publie ton premier article** via N8N
3. **V√©rifie** qu'il appara√Æt sur https://projectview.fr/article/slug

**C'est tout!** üéâ

---

*Commands test√©es pour projectview.fr sur Netlify ‚úÖ*
