# üöÄ Guide d'Installation - N8N Webhook avec Netlify

**Pour Adelin - Configuration simplifi√©e pour Netlify**

---

## ‚ú® Ce Qui Change par Rapport √† Vercel

| √âtape | Vercel | Netlify |
|-------|--------|---------|
| **Endpoint** | `/api/...` | `/.netlify/functions/...` |
| **Config** | Vercel dashboard | `netlify.toml` |
| **Env vars** | Vercel dashboard | Netlify dashboard + `netlify.toml` |
| **Functions** | `api/` folder | `netlify/functions/` folder |

**Bonne nouvelle**: Les √©tapes d'installation restent pratiquement identiques!

---

## üìã √âtapes √† Suivre (Adapt√©es pour Netlify)

### üöÄ **√âTAPE 1: Obtenir un Token GitHub** (5 minutes)

**C'est identique pour Vercel et Netlify!**

1. **Va sur** https://github.com/settings/tokens
2. **Clique** "Generate new token" ‚Üí "Generate new token (classic)"
3. **S√©lectionne les permissions**:
   - ‚úÖ `repo` (acc√®s complet aux repos)
   - ‚úÖ `workflow` (mettre √† jour les GitHub Actions)
4. **Clique** "Generate token"
5. **Copie le token** (tu ne pourras plus le voir apr√®s!)

---

### üîê **√âTAPE 2: Ajouter le Token √† Netlify** (3 minutes)

**C'est l√©g√®rement diff√©rent de Vercel:**

1. **Va sur** https://app.netlify.com
2. **Clique sur ton site** (Projectview)
3. **Va sur** Site settings ‚Üí Build & deploy ‚Üí Environment
4. **Clique** "Edit variables" (ou "+ Add a variable")
5. **Ajoute 3 variables d'environnement**:

   ```
   Key: GITHUB_TOKEN
   Value: (colle ton token GitHub)

   Key: GITHUB_REPO_OWNER
   Value: adelinhugot

   Key: GITHUB_REPO_NAME
   Value: site-projectview
   ```

6. **Clique** Save
7. **Red√©ploie** (va sur "Deployments" et clique "Trigger deploy")

---

### üß™ **√âTAPE 3: Trouver ton URL de Webhook** (1 minute)

Avec Netlify, l'URL du webhook est:

```
https://TON-SITE.netlify.app/.netlify/functions/n8n-webhook
```

**Remplace `TON-SITE` par le nom de ton site Netlify.**

**Comment le trouver?**
1. Va sur https://app.netlify.com
2. Clique sur ton site
3. Cherche le domaine en haut (ex: `projectview-site.netlify.app`)
4. Ton URL est: `https://projectview-site.netlify.app/.netlify/functions/n8n-webhook`

---

### ‚úÖ **√âTAPE 4: Tester le Webhook** (2 minutes)

**Lance cette commande dans le terminal** (adapte l'URL avec ton domaine):

```bash
curl -X POST https://TON-SITE.netlify.app/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"test-article\"\ntitle: \"Test Article\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\"]\nauthor: \"ProjectBot\"\n---\n\n# Test Article\n\nCeci est un test.",
    "frontmatter": {
      "id": "test-article",
      "title": "Test Article",
      "category": "Guide Informatif",
      "date": "2025-10-26",
      "tags": ["test"],
      "author": "ProjectBot"
    },
    "approved": false
  }'
```

**Tu devrais recevoir**:
```json
{
  "status": "pending_approval",
  "message": "Article saved as draft..."
}
```

**Si √ßa marche**: ‚úÖ GitHub et webhook fonctionnent!

---

## üìä **√âTAPE 5 (OPTIONNEL): Google Sheets** (15 minutes)

Exactement comme pour Vercel! Lis `BACKEND_SETUP_GUIDE.md` √©tape 2.

Quand tu dois ajouter les variables √† Netlify:

1. **Va sur** Netlify ‚Üí ton site ‚Üí Site settings ‚Üí Build & deploy ‚Üí Environment
2. **Clique** "Edit variables"
3. **Ajoute 2 nouvelles variables**:
   ```
   GOOGLE_SHEETS_API_KEY = (colle le JSON complet)
   GOOGLE_SHEETS_SPREADSHEET_ID = 13V4v7C3pECzAUaeSN7o3YxSBoY_JD2z23M_--xPP1fw
   ```
4. **Clique** Save
5. **Red√©ploie** le site

---

## üí¨ **√âTAPE 6 (OPTIONNEL): Telegram Notifications** (5 minutes)

Exactement comme pour Vercel! Lis `BACKEND_SETUP_GUIDE.md` √©tape 3.

Quand tu dois ajouter √† Netlify:

1. **Va sur** Netlify ‚Üí ton site ‚Üí Site settings ‚Üí Build & deploy ‚Üí Environment
2. **Clique** "Edit variables"
3. **Ajoute 2 variables**:
   ```
   TELEGRAM_BOT_TOKEN = (ton token)
   TELEGRAM_CHAT_ID = (ton chat ID)
   ```
4. **Clique** Save
5. **Red√©ploie** le site

---

## üîÑ **√âTAPE 7: Configurer N8N** (10 minutes)

Dans ton workflow N8N ProjectBot:

1. **Ajoute un n≈ìud** "HTTP Request"
2. **Configure comme √ßa**:
   ```
   M√©thode: POST
   URL: https://TON-SITE.netlify.app/.netlify/functions/n8n-webhook

   Corps (JSON):
   {
     "articleMarkdown": "{{ $node.ArticleWriter.json.fullMarkdown }}",
     "frontmatter": {{ $node.ArticleWriter.json.frontmatter }},
     "nanobananaPrompts": {{ $node.ArticleWriter.json.prompts }},
     "approved": {{ $node.ApprovalNode.json.approved }}
   }
   ```

3. **Teste** en publiant un article de test

---

## üé¨ **√âTAPE 8: Teste le Flux Complet** (15 minutes)

Identique √† la version Vercel. Lis `QUICKSTART_WEBHOOK.md` √©tape 7.

---

## üìù Diff√©rences Netlify vs Vercel

### URL du Webhook
- **Vercel**: `https://projectview-site.vercel.app/api/n8n-webhook`
- **Netlify**: `https://projectview-site.netlify.app/.netlify/functions/n8n-webhook`

### Configuration des Variables
- **Vercel**: Dashboard ‚Üí Settings ‚Üí Environment Variables
- **Netlify**: Dashboard ‚Üí Site settings ‚Üí Build & deploy ‚Üí Environment

### Dossier des Functions
- **Vercel**: `api/` folder
- **Netlify**: `netlify/functions/` folder

### Fichier de Configuration
- **Vercel**: `vercel.json`
- **Netlify**: `netlify.toml` (d√©j√† mis √† jour!)

---

## üìç Checklist pour Netlify

- [ ] Token GitHub obtenu
- [ ] Netlify: `GITHUB_TOKEN` ajout√©
- [ ] Netlify: `GITHUB_REPO_OWNER` et `GITHUB_REPO_NAME` ajout√©s
- [ ] Site red√©ploy√© sur Netlify
- [ ] URL du webhook trouv√©e
- [ ] Webhook test√© avec curl (article en brouillon)
- [ ] Article exemple visible √† `/article/exemple-test`
- [ ] (Optionnel) Google Sheets configur√©
- [ ] (Optionnel) Telegram configur√©
- [ ] N8N workflow HTTP node configur√©
- [ ] Test complet effectu√© (article publi√©)
- [ ] Articles visibles sur le site

---

## üéØ Commande Rapide Pour Tester Maintenant

**Remplace `projectview-site` par ton domaine Netlify et copie-colle ceci:**

```bash
curl -X POST https://projectview-site.netlify.app/.netlify/functions/n8n-webhook \
  -H "Content-Type: application/json" \
  -d '{
    "articleMarkdown": "---\nid: \"mon-article-test\"\ntitle: \"Mon Article Test\"\ncategory: \"Guide Informatif\"\ndate: \"2025-10-26\"\ntags: [\"test\"]\nauthor: \"ProjectBot\"\n---\n\n# Mon Article Test\n\nCe texte montre que le webhook fonctionne!",
    "frontmatter": {"id": "mon-article-test", "title": "Mon Article Test", "category": "Guide Informatif", "date": "2025-10-26", "tags": ["test"], "author": "ProjectBot"},
    "approved": false
  }'
```

Si tu re√ßois `pending_approval`, c'est bon! üéâ

---

## üÜò Si Quelque Chose Ne Marche Pas avec Netlify

### "Function not found" ou 404 Error
- V√©rifie que le dossier `netlify/functions/` existe
- V√©rifie que le fichier `netlify/functions/n8n-webhook.js` existe
- Attends quelques secondes apr√®s avoir red√©ploy√©
- Force un red√©ploiement: Netlify ‚Üí Deployments ‚Üí "Trigger deploy"

### Webhook retourne une erreur 500
- V√©rifie les logs de la function: Netlify ‚Üí Functions ‚Üí n8n-webhook ‚Üí Logs
- Cherche le message d'erreur exact
- V√©rifie que ton `GITHUB_TOKEN` est correct

### Variables d'environnement non trouv√©es
- V√©rifie que les variables sont ajout√©es dans Netlify dashboard
- V√©rifie que le site a √©t√© red√©ploy√© apr√®s l'ajout des variables
- V√©rifie qu'il n'y a pas de typo dans le nom des variables

### Git commit ne fonctionne pas
- V√©rifie que `GITHUB_TOKEN` a les permissions `repo` et `workflow`
- V√©rifie que tu es autoris√© √† pusher vers le repo
- V√©rifie les logs de la function Netlify pour plus de d√©tails

---

## üì± Red√©ployer Apr√®s Modifications

Apr√®s avoir fait n'importe quelle modification importante (ajouter des variables, changer le code, etc.):

1. **Commit et pousse vers GitHub**:
   ```bash
   git add .
   git commit -m "Update Netlify configuration"
   git push origin main
   ```

2. **Netlify red√©ploiera automatiquement** depuis GitHub

3. **Ou red√©ploie manuellement**:
   - Netlify ‚Üí Deployments ‚Üí "Trigger deploy"

---

## üìö Guides Complets

Tous les guides g√©n√©raux (avec des r√©f√©rences √† Vercel) s'appliquent aussi √† Netlify:

| Document | Utilisation |
|----------|------------|
| **QUICKSTART_WEBHOOK.md** | Setup rapide (adapte juste l'URL et le dashboard) |
| **BACKEND_SETUP_GUIDE.md** | Setup d√©taill√©e Google Sheets & Telegram |
| **api/WEBHOOK_README.md** | Documentation API (identique pour Netlify) |
| **N8N_INTEGRATION_SUMMARY.md** | Architecture syst√®me |
| **IMPLEMENTATION_COMPLETE.md** | R√©sum√© de ce qui a √©t√© fait |

---

## ‚è±Ô∏è Temps Total avec Netlify

- **Minimum (juste GitHub)**: ~12 minutes
- **Complet (GitHub + Google Sheets + Telegram)**: ~45 minutes
- **Avec tests et v√©rifications**: ~60 minutes

---

## üéØ Prochaine √âtape

**Commence par l'√©tape 1** (GitHub token) et tu auras des articles automatis√©s en moins d'une heure avec Netlify! üöÄ

**La seule diff√©rence r√©elle**: L'URL du webhook change d'une plateforme √† l'autre. Tout le reste fonctionne exactement pareil!

---

*Configuration Netlify ajout√©e et test√©e ‚úÖ*
